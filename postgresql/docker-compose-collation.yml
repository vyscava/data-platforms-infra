name: postgres-collation-stack
services:
  pg-collation-fix:
    image: postgres:17@sha256:6a2fb9aaf22abf4c5aeeeb8fcd12dfb57b7531d8d5196f90cfe0ce3f68c4c13f
    restart: "no"
    environment:
      PGUSER: ${POSTGRES_USER}
      PGPASSWORD: ${POSTGRES_PASSWORD}
      PGDATABASE: postgres
      PGHOST: 192.168.50.2
      PGPORT: 5434
    volumes:
      - ./fix_collation.sh:/usr/local/bin/fix_collation.sh:ro
    entrypoint: ["/bin/sh","-lc"]
    command: ["/usr/local/bin/fix_collation.sh"]
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "5"